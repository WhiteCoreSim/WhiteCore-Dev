<!-- User Purchases -->

<div id="fullPage">
  <h2>{UserName}: {PurchasesText}</h2>

  <form class="form form-inline" role="form" id="purchases_search_form" action="user/user_purchases.html" method="post">

  	<div class="form-fieldset-range text-left">
  			<div class="form-group col-xs-12 col-sm-4">
          <div class="col-xs-5">
  				  <label>{DateStartText}</label>
          </div>
          <div class="col-xs-7">
  				  <input class="form-control" type="text" style="width:100px;" name="date_start" id="date_start" value="{DateStart}" />
          </div>
        </div>

        <div class="form-group col-xs-12 col-sm-5">
          <div class="col-xs-4">
  				  <label>{DateEndText}</label>
          </div>
          <div class="col-xs-4">
  			  	<input class="form-control" type="text" style="width:100px;" name="date_end" id="date_end" value="{DateEnd}" />
          </div>
          <div class="col-xs-4">
            <label>{Period}</label>
          </div>
        </div>
        <div class="form-group col-xs-12 col-sm-3">
		      <input hidden type="hidden" label="Submit" id="Submit" name="Submit" value="Submit" />
  				<button class="btn btn-sm btn-success" id="Submit" type="Submit" name="Submit">{Search}</button>
        </div>
   	</div>
     <legend class="pull-left">{DateInfoText}</legend>
  </form>

  <table class="table table-bordered" id="purchases_list">
	  <thead class="listhead">
   		<tr>
   		  <th><p>{PurchaseDateText}</p></th>
   		  <th><p>{PurchaseAgentText}</p></th>
   		  <th><p>{LoggedIPText}</p></th>
   		  <th><p>{PurchaseDetailText}</p></th>
   		  <th><p>{PurchaseAmountText}</p></th>
   		  <th><p>{PurchaseRealAmountText}</p></th>
   		</tr>
 	  </thead>

    <tbody>
  	  {PurchasesListArrayBegin}
      <tr>
        <td><p>{PurchaseDate}</p></td>
        <td><p>{AgentName}</p></td>
        <td><p>{LoggedIP}</p></td>
        <td><p>{Description}</p></td>
        <td><p>{Amount}</p></td>
        <td><p>{RealAmount}</p></td>
      </tr>
  	  {PurchasesListArrayEnd}
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function() {
    $('#purchases_list').dataTable({
      "order": [[ 0, "asc" ]],
      "aoColumnDefs": [{"bSortable":false,"aTargets":["no-sort"]}],
      /*"aaSorting":[], */
      "oLanguage": {"sSearch": "Filter: "},
    });
  });

  $(function() {
    $('#date_start,#date_end').datepicker({
      showTrigger: '<button type="button" class="trigger">...</button>'});
  });

  <!--  /* date pickers */ -->
  $(function() {
    $( "#date_start" ).datepicker( {
      orientation: "bottom left",
      defaultDate: "-1w",
      changeMonth: true,
      numberOfMonths: 3,
      onClose: function( selectedDate ) {
        $( "#to" ).datepicker( "option", "minDate", selectedDate );
      }
    });
    $( "#date_end" ).datepicker( {
      //defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      onClose: function( selectedDate ) {
        $( "#from" ).datepicker( "option", "maxDate", selectedDate );
      }
    });
  });

  /* attach a submit handler to the form */
  $("#purchases_search_form").submit(function(event) {

    /* stop form from submitting normally */
    event.preventDefault();
    /* get some values from elements on the page: */
    var $form = $( this ),
        url = $form.attr( 'action' );
    /* Send the data using post and put the results in a div */
    $.post( url, $form.serialize(), function( data ) {
      $("#fullPage").empty().append(data);
    });
  });
</script>

